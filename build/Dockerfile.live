# syntax=docker/dockerfile:1

FROM golang:1.24.2@sha256:d9db32125db0c3a680cfb7a1afcaefb89c898a075ec148fdc2f0f646cc2ed509 AS runtime

WORKDIR /app

COPY go.mod go.sum ./

RUN go mod download -x

RUN go install github.com/air-verse/air@latest

ENV GOFLAGS="-buildvcs=false"

CMD [ \
    "air", \
    "-c", ".air.toml", \
    "-build.cmd", "go build -o ./tmp/main ./cmd/server" \
]